# 🔄 סנכרון אוטומטי - מדריך שימוש

## 📋 סקירה כללית

מערכת הסנכרון האוטומטי מעדכנת את Outlook אוטומטית עם ציונים וקטגוריות מהמערכת.

---

## 🚀 **שלושה דרכים להשתמש:**

### **1️⃣ סנכרון חד-פעמי (מהיר)**

כשיש לך מיילים חדשים, הרץ:

```powershell
python auto_sync_outlook.py --once
```

**תוצאה:**
```
🔄 מתחיל סנכרון...
📊 נטענו 301 ציונים מהמערכת
✅ סנכרון הושלם:
   📧 סה"כ: 302 מיילים
   🔄 עודכנו: 5
   ➕ חדשים: 2
   ⏭️  כבר מסונכרנים: 295
```

---

### **2️⃣ סנכרון אוטומטי רציף (ברקע)**

רץ ברקע ומסנכרן אוטומטית כל 5 דקות:

```powershell
python auto_sync_outlook.py
```

או כל 10 דקות:

```powershell
python auto_sync_outlook.py --interval 600
```

**לעצירה:** לחץ `Ctrl+C`

---

### **3️⃣ כפתור בממשק הווב**

כשהמערכת רצה (http://localhost:5000):

```javascript
// הכפתור כבר נוסף לאינטרפייס!
// לחץ על "סנכרון Outlook" 🔄
```

---

## ⚙️ **הגדרות מתקדמות**

### **שינוי מרווח סנכרון:**

```powershell
# כל דקה (60 שניות)
python auto_sync_outlook.py --interval 60

# כל שעה (3600 שניות)
python auto_sync_outlook.py --interval 3600

# כל 30 שניות (לבדיקות)
python auto_sync_outlook.py --interval 30
```

---

## 🔍 **מה הסנכרון עושה?**

### **לכל מייל:**

1. ✅ בודק אם יש ציון במערכת
2. ✅ משווה לציון הנוכחי ב-Outlook
3. ✅ מעדכן רק אם צריך (חכם!)
4. ✅ מעדכן גם קטגוריות וצבעים

### **מיילים חדשים:**

- אם אין ציון במערכת → חישוב חכם אוטומטי
- אם יש ציון במערכת → שימוש בציון מהמערכת

---

## 📊 **דוגמת פלט:**

```
================================================================================
🔄 סנכרון אוטומטי Outlook ↔ המערכת
================================================================================
⏱️  מרווח סנכרון: 300 שניות (5.0 דקות)
💡 לחץ Ctrl+C לעצירה
================================================================================

🔄 [14:30:15] מתחיל סנכרון...
📊 נטענו 301 ציונים מהמערכת
✅ סנכרון הושלם:
   📧 סה"כ: 302 מיילים
   🔄 עודכנו: 3
   ➕ חדשים: 1
   ⏭️  כבר מסונכרנים: 298

⏳ ממתין 300 שניות לסנכרון הבא...

🔄 [14:35:15] מתחיל סנכרון...
📊 נטענו 301 ציונים מהמערכת
✅ סנכרון הושלם:
   📧 סה"כ: 302 מיילים
   🔄 עודכנו: 0
   ➕ חדשים: 0
   ⏭️  כבר מסונכרנים: 302
```

---

## 🎯 **המלצות שימוש**

### **למשתמש יומיומי:**
```powershell
# הרץ פעם בבוקר
python auto_sync_outlook.py --once
```

### **לפיתוח אקטיבי:**
```powershell
# השאר רץ ברקע (כל 5 דקות)
python auto_sync_outlook.py
```

### **לסביבת ייצור:**
```powershell
# רץ ברקע עם מרווח ארוך יותר
python auto_sync_outlook.py --interval 900  # כל 15 דקות
```

---

## 🛠️ **פתרון בעיות**

### **"שגיאה בהתחברות ל-Outlook"**
- ודא ש-Outlook פתוח
- בדוק שיש מיילים בתיבת הדואר הנכנס

### **"לא נמצאו ציונים במערכת"**
```powershell
# אכלס את בסיס הנתונים
python populate_db_from_outlook.py
```

### **"הציונים לא משתנים"**
- בדוק ש-`email_manager.db` קיים
- וודא שהמערכת רצה (`python app_with_ai.py`)

---

## 📁 **קבצים קשורים**

- `auto_sync_outlook.py` - הסנכרון האוטומטי
- `populate_db_from_outlook.py` - אכלוס ראשוני
- `app_with_ai.py` - המערכת הראשית (עם כפתור סנכרון)
- `email_manager.db` - בסיס הנתונים

---

## 💡 **טיפים**

1. **הרץ את המערכת הראשונה:**
   ```powershell
   python app_with_ai.py
   ```

2. **פתח דפדפן:**
   ```
   http://localhost:5000
   ```

3. **הפעל סנכרון אוטומטי:**
   ```powershell
   python auto_sync_outlook.py
   ```

4. **תיהנה מסנכרון אוטומטי!** 🎉

---

## ⚡ **הפעלה מהירה (Quick Start)**

```powershell
# 1. אכלס בסיס נתונים (רק פעם אחת)
python populate_db_from_outlook.py

# 2. הרץ את המערכת
python app_with_ai.py

# 3. בחלון נפרד - הפעל סנכרון
python auto_sync_outlook.py
```

**זהו! המערכת מסונכרנת אוטומטית! 🚀**









