# 🧪 בדיקת שדות פגישות ב-Outlook

## מטרת הבדיקה
לוודא שכל השדות מתאכלסים כראוי לאחר ניתוח פגישה ב-Outlook:
- ✅ PRIORITYNUM (עמודת מספר)
- ✅ AISCORE (עמודת טקסט עם %)
- ✅ Categories (קטגוריות Outlook)
- ✅ Importance (דחיפות High/Normal/Low)

---

## שלב 1: הכנה

### 1.1 וודא שהשרת רץ
```bash
python app_with_ai.py
```

### 1.2 וודא שיש GEMINI_API_KEY בקובץ .env
```
GEMINI_API_KEY=your_key_here
```

### 1.3 בנה והתקן את ה-VSTO Add-in
1. פתח `AIEmailManagerAddin.sln` ב-Visual Studio
2. בנה בתצורת **Debug**
3. לחץ F5 להרצה

---

## שלב 2: ניתוח פגישה

### 2.1 בחר פגישה ב-Outlook Calendar
1. פתח Outlook → Calendar
2. בחר פגישה קיימת (או צור חדשה)
3. לחץ על כפתור **"ניתח פגישה"** ברצועת הכלים

### 2.2 בדוק את הקונסול (בדפדפן)
1. פתח `http://localhost:5000/consol`
2. חפש בלוק:
   ```
   📅 ניתוח AI פגישה: [שם הפגישה]
   ├─ 🤖 מנתח: [שם הפגישה המלא]
   ├─ 📊 ציון חשיבות: 75%
   ├─ 📝 סיכום: [סיכום קצר]...
   └─ ✅ הניתוח הושלם בהצלחה - ציון: 75%
   ```

### 2.3 בדוק את Debug Output ב-Visual Studio
1. View → Output
2. בחר "Debug" בתפריט הנפתח
3. חפש:
   ```
   🏷️ קטגוריה עודכנה: [שם קטגוריה]
   ✅ הפגישה נשמרה עם ציון XX
   ```

---

## שלב 3: בדיקת העמודות ב-Outlook

### 3.1 עבור לתצוגת List (רשימה)
1. Outlook → Calendar
2. **View → Change View → List**

### 3.2 הוסף עמודות מותאמות אישית

#### עמודה 1: PRIORITYNUM (מספר)
1. לחץ ימני על כותרות העמודות
2. **View Settings... → Columns... → New Column...**
3. הזן:
   - **Name:** `PRIORITYNUM`
   - **Type:** `Number`
   - **Format:** `Number`
4. לחץ OK → Add → OK

#### עמודה 2: AISCORE (טקסט)
1. לחץ ימני על כותרות העמודות
2. **View Settings... → Columns... → New Column...**
3. הזן:
   - **Name:** `AISCORE`
   - **Type:** `Text`
4. לחץ OK → Add → OK

#### עמודה 3: Categories (מובנית)
1. לחץ ימני על כותרות העמודות
2. **View Settings... → Columns...**
3. מצא **"Categories"** ברשימה
4. לחץ **Add** → OK

#### עמודה 4: Importance (מובנית)
1. לחץ ימני על כותרות העמודות
2. **View Settings... → Columns...**
3. מצא **"Importance"** ברשימה
4. לחץ **Add** → OK

---

## שלב 4: בדיקת התוצאות

### 4.1 מצא את הפגישה שניתחת
- חפש אותה ברשימה (List View)

### 4.2 בדוק כל עמודה

| עמודה | מה צריך להופיע | דוגמה |
|-------|----------------|-------|
| **PRIORITYNUM** | מספר שלם (0-100) | `75` |
| **AISCORE** | טקסט עם % | `75%` |
| **Categories** | שם קטגוריה | `פגישת עבודה` |
| **Importance** | High/Normal/Low | `High` |

### 4.3 תוצאות צפויות

#### ✅ הצלחה:
```
Subject                PRIORITYNUM  AISCORE  Categories      Importance
─────────────────────  ──────────  ───────  ─────────────  ──────────
פגישת סטטוס חודשית    75          75%      פגישת עבודה   High
```

#### ❌ בעיה:
אם אחד השדות ריק:
```
Subject                PRIORITYNUM  AISCORE  Categories  Importance
─────────────────────  ──────────  ───────  ──────────  ──────────
פגישת סטטוס חודשית    (ריק)       (ריק)    (ריק)       Normal
```

---

## שלב 5: בדיקת השוואה עם מייל

### 5.1 נתח מייל
1. Outlook → Mail
2. בחר מייל
3. לחץ **"ניתח מייל"**

### 5.2 הוסף עמודות למיילים (זהה לפגישות)
1. View → View Settings → Columns
2. הוסף `PRIORITYNUM`, `AISCORE`, `Categories`, `Importance`

### 5.3 השווה תוצאות

| פריט | PRIORITYNUM | AISCORE | Categories | Importance |
|------|------------|---------|------------|------------|
| **מייל** | ✅ | ✅ | ✅ | ✅ |
| **פגישה** | ✅ | ✅ | ✅ | ✅ |

**✅ אם כל השדות זהים - הכל עובד כמצופה!**

---

## 🐛 פתרון בעיות

### בעיה 1: PRIORITYNUM ריק בפגישה
**גורם אפשרי:**
- השרת לא מחזיר `importance_score`
- הקוד C# לא מצליח לשמור

**פתרון:**
1. בדוק קונסול - האם יש ציון?
2. בדוק Debug Output - האם יש שגיאה בשמירה?
3. נסה לנתח שוב

### בעיה 2: Categories ריק בפגישה
**גורם אפשרי:**
- השרת לא מחזיר `category`

**פתרון:**
1. בדוק בקונסול מה השרת מחזיר
2. בדוק Debug Output - האם יש "🏷️ קטגוריה עודכנה"?

### בעיה 3: Importance לא משתנה
**גורם אפשרי:**
- הציון לא עובר את הסף (80 = High, 50 = Normal)

**פתרון:**
1. בדוק את הציון ב-PRIORITYNUM
2. אם הציון מעל 80 - אמור להיות High
3. אם הציון 50-79 - אמור להיות Normal
4. אם הציון מתחת ל-50 - אמור להיות Low

---

## 📊 סיכום

### מה בדקנו?
- ✅ שדות מתאכלסים בפגישות
- ✅ שדות מתאכלסים במיילים
- ✅ השוואה בין פגישות למיילים

### מה צפוי?
כל השדות צריכים להיות **זהים לחלוטין** בין מיילים לפגישות:
- PRIORITYNUM: מספר 0-100
- AISCORE: טקסט עם %
- Categories: קטגוריה מה-AI
- Importance: High/Normal/Low לפי הציון

### האם הכל עובד?
אם כל הבדיקות עברו בהצלחה - **הכל עובד מושלם! ✅**

