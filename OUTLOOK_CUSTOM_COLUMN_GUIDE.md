# מדריך: הוספת עמודת ציון חשיבות לפגישות ב-Outlook

## 📋 סקירה כללית

המערכת כעת שומרת את ציון החשיבות של פגישות ב-**UserProperty** בשם `PRIORITYNUM`.
כדי לראות את הציון בתצוגת הפגישות, צריך להוסיף עמודה מותאמת אישית ב-Outlook.

---

## 🎯 שלבי ההגדרה

### שלב 1: פתיחת תצוגת פגישות
1. **פתח Outlook**
2. **עבור ללוח שנה (Calendar)** - לחץ על האייקון "📅 לוח שנה" בתפריט התחתון
3. **בחר את תצוגת הרשימה** - לחץ על "View" → "Change View" → "List"

---

### שלב 2: הוספת עמודה מותאמת אישית

#### דרך 1: תפריט View Settings
1. **לחץ ימני על כותרות העמודות** (שורת הכותרות העליונה)
2. **בחר "View Settings..."** (הגדרות תצוגה)
3. **לחץ על "Columns..."** (עמודות)
4. **לחץ על "New Column..."** (עמודה חדשה)

#### דרך 2: תפריט View ברצועת הכלים
1. **View** (תצוגה) ברצועת הכלים העליונה
2. **View Settings** (הגדרות תצוגה)
3. **Columns...** (עמודות)
4. **New Column...** (עמודה חדשה)

---

### שלב 3: יצירת עמודת PRIORITYNUM

בחלון "New Column":

#### הגדרות בסיסיות:
| שדה | ערך |
|-----|-----|
| **Name** (שם) | `PRIORITYNUM` או `AI Score` (לפי העדפה) |
| **Type** (סוג) | **Number** (מספר) |
| **Format** (פורמט) | **Number** (מספר רגיל) |

#### הגדרות נוספות (אופציונליות):
- **Display Format**: ללא עיצוב מיוחד
- **Decimal Places**: 0 (ללא ספרות אחרי הנקודה)

---

### שלב 4: שמירה והצגה

1. **לחץ OK** בחלון "New Column"
2. **בחלון "Show Columns":**
   - מצא את `PRIORITYNUM` ברשימת השדות הזמינים
   - **לחץ "Add"** כדי להוסיף אותה לעמודות המוצגות
   - **השתמש ב-"Move Up"/"Move Down"** כדי לשנות את מיקום העמודה
3. **לחץ OK** בכל החלונות

---

## 📊 תוצאה צפויה

לאחר ההגדרה, תראה:
- **עמודה חדשה** בשם `PRIORITYNUM` (או `AI Score`)
- **ציון בין 0-100** לפגישות שנותחו
- **ערך ריק** לפגישות שטרם נותחו

---

## 🔍 בדיקה

### איך לבדוק שהעמודה עובדת:

1. **נתח פגישה:**
   - בחר פגישה ב-Outlook
   - לחץ על כפתור **"ניתח פגישה"** ב-Ribbon של AI Email Manager
   - המתן לסיום הניתוח

2. **בדוק את העמודה:**
   - חזור לתצוגת הרשימה (List View)
   - הסתכל על עמודת `PRIORITYNUM`
   - אמור לראות ציון (למשל: 75, 82, 90...)

---

## ⚙️ הגדרות נוספות (אופציונליות)

### מיון לפי ציון חשיבות:
1. **לחץ על כותרת העמודה** `PRIORITYNUM`
2. **לחץ שוב** כדי להפוך את סדר המיון (מהגבוה לנמוך / מהנמוך לגבוה)

### פילטור לפי ציון:
1. **View Settings** → **Filter...**
2. **Advanced** tab
3. **Field:** בחר "User-defined fields in folder" → `PRIORITYNUM`
4. **Condition:** למשל "greater than" (גדול מ-)
5. **Value:** למשל 70
6. **Add to List** → **OK**

### עיצוב מותנה (Conditional Formatting):
1. **View Settings** → **Conditional Formatting...**
2. **Add** → תן שם (למשל "חשיבות גבוהה")
3. **Condition...** → הגדר `PRIORITYNUM > 80`
4. **Font** → בחר צבע (למשל אדום לחשיבות גבוהה)

---

## 🐛 פתרון בעיות

### העמודה לא מופיעה ברשימת השדות
**פתרון:**
1. נתח לפחות פגישה אחת דרך ה-Add-in
2. סגור את Outlook ופתח שוב
3. נסה שוב להוסיף את העמודה

### העמודה ריקה לאחר ניתוח
**פתרון:**
1. **בדוק Debug Output** ב-Visual Studio:
   - Output Window → Debug
   - חפש הודעות: "✅ פגישה נשמרה: ... - ציון XX"
2. **וודא שהשרת Python פועל** (`http://127.0.0.1:5000`)
3. **נסה לנתח שוב** את הפגישה

### הערך מוצג כטקסט במקום מספר
**פתרון:**
- בהגדרות העמודה, וודא ש-**Type = Number** ולא Text

---

## 📝 הערות חשובות

1. **שם השדה חייב להיות `PRIORITYNUM`** - זה השם שהקוד משתמש בו
2. **סוג השדה חייב להיות Number** - זה מאפשר מיון ופילטור נכונים
3. **העמודה תוצג רק לפגישות שנותחו** - פגישות ישנות לא יהיה להן ערך
4. **אפשר להוסיף גם את `AISCORE`** (טקסט עם %) באותה דרך

---

## 📧 עמודה דומה למיילים

אם רוצה להוסיף עמודה דומה **לתיבת הדואר** (Inbox):
1. **עבור לתיבת הדואר** (Mail)
2. **View Settings** → **Columns...**
3. **בחר "User-defined fields in folder"** מהרשימה הנפתחת
4. **מצא `PRIORITYNUM`** - אמור להיות כבר שם (אם ניתחת מיילים)
5. **Add** → **OK**

---

## ✅ סיכום

לאחר ביצוע שלבים אלה:
- ✅ תראה את ציון החשיבות של פגישות
- ✅ תוכל למיין ולסנן פגישות לפי חשיבות
- ✅ תוכל לתעדף פגישות חשובות בקלות

**בהצלחה!** 🎉





